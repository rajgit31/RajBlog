<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<post>
  <author>rajitha_kba</author>
  <title>Attribute based Performance Counters with Enterprise Library 4.1</title>
  <description />
  <content>&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&lt;span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: &amp;quot;Times New Roman&amp;quot;; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri; color: black; mso-themecolor: text1; mso-fareast-language: EN-AU;"&gt;This post is based on my previous post on &lt;a href="http://blog.rajsoftware.com/post/2010/08/21/Getting-started-with-Enterprise-Library-Performance-Counters.aspx" target="_blank"&gt;Getting started with Enterprise Library Performance Counters&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height:normal;background:white"&gt;&amp;nbsp;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&lt;span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: &amp;quot;Times New Roman&amp;quot;; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri; color: black; mso-themecolor: text1; mso-fareast-language: EN-AU;"&gt;Let&amp;rsquo;s assume you don&amp;rsquo;t want to use the config files to configure performance counters. You need to use the &lt;em style="mso-bidi-font-style: normal;"&gt;PerformanceCounterCallHandlers&lt;/em&gt;.&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&lt;span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: &amp;quot;Times New Roman&amp;quot;; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri; color: black; mso-themecolor: text1; mso-fareast-language: EN-AU;"&gt;In order to achieve this, you need to follow the same steps - until step number 7, which I have stated in my previous post.&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&lt;span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: &amp;quot;Times New Roman&amp;quot;; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri; color: black; mso-themecolor: text1; mso-fareast-language: EN-AU;"&gt;Step number 8 is different. Your config file will only contain the below.&amp;nbsp;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;mso-layout-grid-align:none;text-autospace:none"&gt;&lt;span style="font-size: 9.5pt;font-family:Consolas;color:blue"&gt;&amp;lt;&lt;/span&gt;&lt;span style="font-size:9.5pt; font-family:Consolas;color:#A31515"&gt;configuration&lt;/span&gt;&lt;span style="font-size: 9.5pt;font-family:Consolas;color:blue"&gt;&amp;gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;mso-layout-grid-align:none;text-autospace:none"&gt;&lt;span style="font-size: 9.5pt;font-family:Consolas;color:blue"&gt;&lt;span style="mso-spacerun:yes"&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&amp;lt;&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:#A31515"&gt;configSections&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:blue"&gt;&amp;gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;mso-layout-grid-align:none;text-autospace:none"&gt;&lt;span style="font-size: 9.5pt;font-family:Consolas;color:blue"&gt;&lt;span style="mso-spacerun:yes"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&amp;lt;&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:#A31515"&gt;section&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:blue"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:red"&gt;name&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:blue"&gt;=&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas"&gt;"&lt;span style="color:blue"&gt;dataConfiguration&lt;/span&gt;"&lt;span style="color:blue"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color:red"&gt;type&lt;/span&gt;&lt;span style="color:blue"&gt;=&lt;/span&gt;"&lt;span style="color:blue"&gt;Microsoft.Practices.EnterpriseLibrary.Data.Configuration.DatabaseSettings, Microsoft.Practices.EnterpriseLibrary.Data, Version=4.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&lt;/span&gt;"&lt;span style="color:blue"&gt;&amp;nbsp;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;mso-layout-grid-align:none;text-autospace:none"&gt;&lt;span style="font-size: 9.5pt;font-family:Consolas;color:blue"&gt;&lt;span style="mso-spacerun:yes"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&amp;lt;&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:#A31515"&gt;section&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:blue"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:red"&gt;name&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:blue"&gt;=&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas"&gt;"&lt;span style="color:blue"&gt;instrumentationConfiguration&lt;/span&gt;"&lt;span style="color:red"&gt;type&lt;/span&gt;&lt;span style="color:blue"&gt;=&lt;/span&gt;"&lt;span style="color:blue"&gt;Microsoft.Practices.EnterpriseLibrary.Common.Instrumentation.Configuration.InstrumentationConfigurationSection, Microsoft.Practices.EnterpriseLibrary.Common, Version=4.1.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&lt;/span&gt;"&lt;span style="color:blue"&gt;&amp;nbsp;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;mso-layout-grid-align:none;text-autospace:none"&gt;&lt;span style="font-size: 9.5pt;font-family:Consolas;color:blue"&gt;&lt;span style="mso-spacerun:yes"&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&amp;lt;/&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family:Consolas; color:#A31515"&gt;configSections&lt;/span&gt;&lt;span style="font-size:9.5pt;font-family: Consolas;color:blue"&gt;&amp;gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;mso-layout-grid-align:none;text-autospace:none"&gt;&lt;span style="font-size: 9.5pt;font-family:Consolas;color:blue"&gt;&lt;span style="mso-spacerun:yes"&gt;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;strong style="mso-bidi-font-weight:normal"&gt;&amp;lt;&lt;/strong&gt;&lt;/span&gt;&lt;strong style="mso-bidi-font-weight: normal"&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:#A31515"&gt;instrumentationConfiguration&lt;/span&gt;&lt;/strong&gt;&lt;strong style="mso-bidi-font-weight:normal"&gt;&lt;span style="font-size:9.5pt;font-family: Consolas;color:blue"&gt;&amp;nbsp;&lt;/span&gt;&lt;/strong&gt;&lt;strong style="mso-bidi-font-weight:normal"&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:red"&gt;performanceCountersEnabled&lt;/span&gt;&lt;/strong&gt;&lt;strong style="mso-bidi-font-weight:normal"&gt;&lt;span style="font-size:9.5pt;font-family: Consolas;color:blue"&gt;=&lt;/span&gt;&lt;/strong&gt;&lt;strong style="mso-bidi-font-weight:normal"&gt;&lt;span style="font-size:9.5pt;font-family:Consolas"&gt;"&lt;span style="color:blue"&gt;true&lt;/span&gt;"&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;mso-layout-grid-align:none;text-autospace:none"&gt;&lt;strong style="mso-bidi-font-weight: normal"&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:blue"&gt;&lt;span style="mso-spacerun:yes"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;strong style="mso-bidi-font-weight: normal"&gt;&lt;span style="font-size:9.5pt;font-family:Consolas;color:red"&gt;eventLoggingEnabled&lt;/span&gt;&lt;/strong&gt;&lt;strong style="mso-bidi-font-weight:normal"&gt;&lt;span style="font-size:9.5pt;font-family: Consolas;color:blue"&gt;=&lt;/span&gt;&lt;/strong&gt;&lt;strong style="mso-bidi-font-weight:normal"&gt;&lt;span style="font-size:9.5pt;font-family:Consolas"&gt;"&lt;span style="color:blue"&gt;false&lt;/span&gt;"&lt;span style="color:blue"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color:red"&gt;wmiEnabled&lt;/span&gt;&lt;span style="color:blue"&gt;=&lt;/span&gt;"&lt;span style="color:blue"&gt;false&lt;/span&gt;"&lt;span style="color:blue"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="color:red"&gt;applicationInstanceName&lt;/span&gt;&lt;span style="color:blue"&gt;=&lt;/span&gt;""&lt;span style="color:blue"&gt;&amp;nbsp;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom:0cm;margin-bottom:.0001pt;line-height: normal;mso-layout-grid-align:none;text-autospace:none"&gt;&lt;span style="font-size: 9.5pt;font-family:Consolas;color:blue"&gt;&amp;lt;/&lt;/span&gt;&lt;span style="font-size:9.5pt; font-family:Consolas;color:#A31515"&gt;configuration&lt;/span&gt;&lt;span style="font-size: 9.5pt;font-family:Consolas;color:blue"&gt;&amp;gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&amp;nbsp;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&lt;span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: &amp;quot;Times New Roman&amp;quot;; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri; color: black; mso-themecolor: text1; mso-fareast-language: EN-AU;"&gt;As you can see above, you can easily turn off the performance counters as a whole entity.&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&lt;span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: &amp;quot;Times New Roman&amp;quot;; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri; color: black; mso-themecolor: text1; mso-fareast-language: EN-AU;"&gt;Now to add performance counters to a target method, you can simply use the &lt;em style="mso-bidi-font-style: normal;"&gt;PerformanceCounterCallHandler &lt;/em&gt;attribute as specified below.&lt;/span&gt;&lt;/p&gt;
&lt;pre class="brush: c-sharp;" style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; margin: 8px;"&gt;&lt;span style="white-space: normal;"&gt;&lt;br /&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;pre class="brush: c-sharp;" style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; margin: 8px;"&gt;[PerformanceCounterCallHandler("DemoCounters", "Operations Started/sec", IncrementCallsPerSecond = true)]
public void SampleMethod(int i)
{
     Console.WriteLine(i);
}
&lt;/pre&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&lt;span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: &amp;quot;Times New Roman&amp;quot;; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri; color: black; mso-themecolor: text1; mso-fareast-language: EN-AU;"&gt;Now you should see the similar results in Windows Performance Monitor as I stated in my previous post.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&lt;span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: &amp;quot;Times New Roman&amp;quot;; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri; color: black; mso-themecolor: text1; mso-fareast-language: EN-AU;"&gt;Note: &lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&lt;span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: &amp;quot;Times New Roman&amp;quot;; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri; color: black; mso-themecolor: text1; mso-fareast-language: EN-AU;"&gt;If you need to know more in &lt;em style="mso-bidi-font-style: normal;"&gt;PerformanceCounterCallHandler &lt;/em&gt;please refer to the below link&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="line-height: normal; background: white;"&gt;&lt;span style="color: blue;"&gt;&lt;a href="http://msdn.microsoft.com/en-us/library/ff648494.aspx"&gt;http://msdn.microsoft.com/en-us/library/ff648494.aspx&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;</content>
  <ispublished>True</ispublished>
  <iscommentsenabled>False</iscommentsenabled>
  <pubDate>2010-08-25 21:29:00</pubDate>
  <lastModified>2010-10-01 00:11:40</lastModified>
  <raters>0</raters>
  <rating>0</rating>
  <slug>Attribute-based-Performance-Counters-with-Enterprise-Library-41</slug>
  <tags />
  <comments />
  <categories>
    <category>6e852331-990d-45ba-8068-1c6e8396a0cf</category>
    <category>fd41e292-56d9-4b00-85ad-dc53bbdaee74</category>
  </categories>
  <notifications />
</post>